<!DOCTYPE HTML><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>以react-script重构antd-pro | WhatAKitty Daily | A Programmer&#39;s Daily Record</title><meta name="author" content="WhatAKitty"><meta name="description" content="Just A Simple Programmer."><meta name="keywords" content="react-script,create-react-app,react,antd,ant-design,ant-design-pro,Blog, SSL, Nodejs, DevOps, Spring, Spring Cloud, Jenkins, Docker, JIRA, CI"><meta id="viewport" name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta property="og:title" content="以react-script重构antd-pro"><meta property="og:site_name" content="WhatAKitty Daily"><meta property="og:image" content="/favicon.ico"><link href="/favicon.ico" rel="icon"><link rel="alternate" href="/atom.xml" title="WhatAKitty Daily" type="application/atom+xml"><link rel="stylesheet" href="/css/style.css" media="screen" type="text/css"></head><body><div class="blog"><div class="content"><header><div class="site-branding"><h1 class="site-title"><a href="/">WhatAKitty Daily</a></h1><p class="site-description">A Programmer&#39;s Daily Record</p></div><nav class="site-navigation"><ul><li><a href="/">主页</a></li><li><a href="/archives">归档</a></li><li><a href="/projects">项目</a></li><li><a href="/categories/JavaSources">Java Sources</a></li><li><a href="/categories/Java/Spring/SpringSources">Spring Sources</a></li><li><a href="/atom.xml">订阅</a></li></ul></nav></header><main class="site-main posts-loop"><article><h3 class="article-title"><span>以react-script重构antd-pro</span></h3><div class="article-top-meta"><span class="posted-on"><a href="/以react-script重构antd-pro.html" rel="bookmark">WhatAKitty &emsp; <time class="entry-date published" datetime="2017-11-08T09:48:24.000Z">2017-11-08 </time>&emsp; <span id="busuanzi_container_page_pv">阅读次数<span id="busuanzi_value_page_pv">loading...</span></span></a></span></div><div class="article-content"><div class="entry"><h3 id="&#x80CC;&#x666F;"><a href="#&#x80CC;&#x666F;" class="headerlink" title="&#x80CC;&#x666F;"></a>&#x80CC;&#x666F;</h3><p>&#x5728;&#x8682;&#x8681;&#x91D1;&#x670D;&#x63A8;&#x51FA;<code>ant-design-pro</code>&#x7684;&#x5F00;&#x6E90;&#x9879;&#x76EE;&#x540E;&#xFF0C;&#x4ED4;&#x7EC6;&#x4E86;&#x89E3;&#x4E86;&#x4E0B;&#xFF0C;&#x6839;&#x636E;&#x5B98;&#x7F51;&#x7684;&#x4ECB;&#x7ECD;&#xFF1A;</p><blockquote><p>&#x5F00;&#x7BB1;&#x5373;&#x7528;&#x7684;&#x4E2D;&#x53F0;&#x524D;&#x7AEF;/&#x8BBE;&#x8BA1;&#x89E3;&#x51B3;&#x65B9;&#x6848;</p></blockquote><p>&#x4E0D;&#x8FC7;&#xFF0C;&#x8BE5;&#x9879;&#x76EE;&#x662F;&#x57FA;&#x4E8E;<code>dva</code>&#x7684;<code>roadhog</code>&#x6784;&#x5EFA;&#xFF0C;&#x6211;&#x66F4;&#x503E;&#x5411;&#x4E8E;&#x4F7F;&#x7528;<code>react-script</code>&#x4F5C;&#x4E3A;&#x811A;&#x624B;&#x67B6;&#xFF0C;&#x6240;&#x4EE5;&#x4E5F;&#x840C;&#x751F;&#x4E86;&#x5C06;&#x73B0;&#x6709;&#x7684;<code>ant-design-pro</code>&#x9879;&#x76EE;&#x7684;&#x57FA;&#x7840;&#x6784;&#x5EFA;&#x5DE5;&#x5177;&#x8FC1;&#x79FB;&#x5230;<code>react-script</code>&#x7684;&#x60F3;&#x6CD5;&#x3002;</p><a id="more"></a><h3 id="&#x8FC7;&#x7A0B;&#x63CF;&#x8FF0;"><a href="#&#x8FC7;&#x7A0B;&#x63CF;&#x8FF0;" class="headerlink" title="&#x8FC7;&#x7A0B;&#x63CF;&#x8FF0;"></a>&#x8FC7;&#x7A0B;&#x63CF;&#x8FF0;</h3><h4 id="1-&#x4F7F;&#x7528;create-react-app&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5DE5;&#x7A0B;"><a href="#1-&#x4F7F;&#x7528;create-react-app&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5DE5;&#x7A0B;" class="headerlink" title="1. &#x4F7F;&#x7528;create-react-app&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5DE5;&#x7A0B;"></a>1. &#x4F7F;&#x7528;<code>create-react-app</code>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5DE5;&#x7A0B;</h4><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create-react-app my-project</span><br><span class="line">cd my-project</span><br></pre></td></tr></tbody></table></figure><h4 id="2-&#x5B89;&#x88C5;react-app-wired&#x548C;less-modules"><a href="#2-&#x5B89;&#x88C5;react-app-wired&#x548C;less-modules" class="headerlink" title="2. &#x5B89;&#x88C5;react-app-wired&#x548C;less-modules"></a>2. &#x5B89;&#x88C5;<code>react-app-wired</code>&#x548C;<code>less-modules</code></h4><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add react-app-rewired react-app-rewire-less-modules@https://github.com/WhatAKitty/react-app-rewire-less-modules less-loader --dev</span><br></pre></td></tr></tbody></table></figure><p>&#x8FD9;&#x4E24;&#x4E2A;&#x6A21;&#x5757;&#x7684;&#x4F5C;&#x7528;&#x4E3B;&#x8981;&#x5728;&#x4E8E;&#xFF1A;&#x6269;&#x5C55;<code>react-script</code>&#x672C;&#x8EAB;&#x7684;<code>webpack</code>&#x914D;&#x7F6E;&#x3002;&#x81F3;&#x4E8E;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x8FD9;&#x4E48;&#x505A;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x4E3A;&#x4E86;&#x7B80;&#x5316;&#x5F00;&#x53D1;&#x6D41;&#x7A0B;&#xFF0C;<code>react-script</code>&#x672C;&#x8EAB;&#x5DF2;&#x7ECF;&#x5C06;&#x6240;&#x6709;&#x914D;&#x7F6E;&#x90FD;&#x9690;&#x85CF;&#x914D;&#x7F6E;&#xFF1B;&#x5982;&#x679C;&#x60F3;&#x8981;&#x81EA;&#x884C;&#x914D;&#x7F6E;&#x4E00;&#x4E9B;&#x63D2;&#x4EF6;&#x6216;&#x8005;&#x8BBE;&#x7F6E;<code>babel</code>&#x5C5E;&#x6027;&#xFF0C;&#x53EA;&#x80FD;&#x901A;&#x8FC7;<code>react-app-wired</code>&#x6765;&#x6269;&#x5C55;&#x3002;</p><h4 id="3-&#x4FEE;&#x6539;&#x542F;&#x52A8;&#x6D4B;&#x8BD5;&#x811A;&#x672C;"><a href="#3-&#x4FEE;&#x6539;&#x542F;&#x52A8;&#x6D4B;&#x8BD5;&#x811A;&#x672C;" class="headerlink" title="3. &#x4FEE;&#x6539;&#x542F;&#x52A8;&#x6D4B;&#x8BD5;&#x811A;&#x672C;"></a>3. &#x4FEE;&#x6539;&#x542F;&#x52A8;&#x6D4B;&#x8BD5;&#x811A;&#x672C;</h4><p>&#x6253;&#x5F00;&#x6839;&#x8DEF;&#x5F84;&#x4E0B;&#x7684;<code>package.json</code>&#x6587;&#x4EF6;&#xFF1A;<br>&#x5C06;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#xFF1A;<br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: {</span><br><span class="line">  &quot;start&quot;: &quot;react-script start&quot;,</span><br><span class="line">  &quot;build&quot;: &quot;react-script build&quot;,</span><br><span class="line">  &quot;test&quot;: &quot;react-script test --env=jsdom&quot;,</span><br><span class="line">  &quot;eject&quot;: &quot;react-scripts eject&quot;</span><br><span class="line">},</span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x4FEE;&#x6539;&#x4E3A;&#xFF1A;<br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: {</span><br><span class="line">  &quot;start&quot;: &quot;react-app-rewired start&quot;,</span><br><span class="line">  &quot;build&quot;: &quot;react-app-rewired build&quot;,</span><br><span class="line">  &quot;test&quot;: &quot;react-app-rewired test --env=jsdom&quot;,</span><br><span class="line">  &quot;eject&quot;: &quot;react-scripts eject&quot;</span><br><span class="line">},</span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="4-&#x521B;&#x5EFA;react-app-wired&#x7684;&#x914D;&#x7F6E;&#x8986;&#x76D6;&#x6587;&#x4EF6;"><a href="#4-&#x521B;&#x5EFA;react-app-wired&#x7684;&#x914D;&#x7F6E;&#x8986;&#x76D6;&#x6587;&#x4EF6;" class="headerlink" title="4. &#x521B;&#x5EFA;react-app-wired&#x7684;&#x914D;&#x7F6E;&#x8986;&#x76D6;&#x6587;&#x4EF6;"></a>4. &#x521B;&#x5EFA;<code>react-app-wired</code>&#x7684;&#x914D;&#x7F6E;&#x8986;&#x76D6;&#x6587;&#x4EF6;</h4><p>&#x65B0;&#x5EFA;&#x6587;&#x4EF6;<code>config-overrides.js</code>&#xFF0C;&#x5C06;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#x5199;&#x5165;&#x6587;&#x4EF6;&#xFF1A;<br></p><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&apos;path&apos;</span>);</span><br><span class="line"><span class="keyword">const</span> { injectBabelPlugin } = <span class="built_in">require</span>(<span class="string">&apos;react-app-rewired&apos;</span>);</span><br><span class="line"><span class="keyword">const</span> rewireLess = <span class="built_in">require</span>(<span class="string">&apos;react-app-rewire-less-modules&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">override</span>(<span class="params">config, env</span>) </span>{</span><br><span class="line">  <span class="comment">// &#x652F;&#x6301;es7&#x7684;`@`&#x7279;&#x6027;</span></span><br><span class="line">  config = injectBabelPlugin(<span class="string">&apos;transform-decorators-legacy&apos;</span>, config);</span><br><span class="line">  config = injectBabelPlugin([<span class="string">&apos;import&apos;</span>, { <span class="attr">libraryName</span>: <span class="string">&apos;antd&apos;</span>, <span class="attr">style</span>: <span class="literal">true</span> }], config);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// webpack externals&#x5C5E;&#x6027;</span></span><br><span class="line">  config.externals = {</span><br><span class="line">    <span class="string">&quot;g2&quot;</span>: <span class="string">&quot;G2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;g-cloud&quot;</span>: <span class="string">&quot;Cloud&quot;</span>,</span><br><span class="line">    <span class="string">&quot;g2-plugin-slider&quot;</span>: <span class="string">&quot;G2.Plugin.slider&quot;</span></span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="comment">// &#x652F;&#x6301;less&#x7684;css&#x6A21;&#x5757;&#x5316;</span></span><br><span class="line">  <span class="keyword">return</span> rewireLess.withLoaderOptions(</span><br><span class="line">    <span class="string">`<span class="subst">${env === <span class="string">&apos;production&apos;</span> ? <span class="string">&apos;app&apos;</span> : <span class="string">&apos;[local]&apos;</span>}</span>-[hash:base64:8]`</span>,</span><br><span class="line">    {</span><br><span class="line">      <span class="comment">// &#x8986;&#x76D6;antd&#x7684;&#x4E3B;&#x9898;&#x5C5E;&#x6027;&#xFF0C;&#x5177;&#x4F53;&#x8BE6;&#x7EC6;&#x53D8;&#x91CF;&#x8BF7;&#x67E5;&#x770B;&#xFF1A;https://github.com/ant-design/ant-design/blob/master/components/style/themes/default.less</span></span><br><span class="line">      modifyVars: {</span><br><span class="line">        <span class="string">&apos;@primary-color&apos;</span>: <span class="string">&apos;#1DA57A&apos;</span>,</span><br><span class="line">        <span class="string">&apos;@link-color&apos;</span>: <span class="string">&apos;#1DA57A&apos;</span>,</span><br><span class="line">        <span class="string">&apos;@border-radius-base&apos;</span>: <span class="string">&apos;2px&apos;</span>,</span><br><span class="line">        <span class="string">&apos;@font-size-base&apos;</span>: <span class="string">&apos;14px&apos;</span>,</span><br><span class="line">        <span class="string">&apos;@line-height-base&apos;</span>: <span class="string">&apos;1.2&apos;</span>,</span><br><span class="line">        <span class="string">&apos;@card-actions-background&apos;</span>: <span class="string">&apos;#f5f8fa&apos;</span>,</span><br><span class="line">      }</span><br><span class="line">    },</span><br><span class="line">    <span class="comment">// &#x5C06;/src/&#x8DEF;&#x5F84;&#x5305;&#x542B;&#x5230;css&#x6A21;&#x5757;&#x5316;&#x5185;&#xFF0C;&#x9ED8;&#x8BA4;&#x4F1A;&#x5C06;/node_modules/&#x8DEF;&#x5F84;&#x6392;&#x9664;&#x5728;css&#x6A21;&#x5757;&#x5316;&#x5916;&#xFF0C;&#x5177;&#x4F53;&#x914D;&#x7F6E;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#xFF1A;https://github.com/WhatAKitty/react-app-rewire-less-modules</span></span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`<span class="subst">${path.sep}</span>src<span class="subst">${path.sep}</span>`</span>),</span><br><span class="line">  )(config, env);</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p></p><h4 id="5-&#x5B89;&#x88C5;ant-design-pro&#x9700;&#x8981;&#x7684;&#x4F9D;&#x8D56;"><a href="#5-&#x5B89;&#x88C5;ant-design-pro&#x9700;&#x8981;&#x7684;&#x4F9D;&#x8D56;" class="headerlink" title="5. &#x5B89;&#x88C5;ant-design-pro&#x9700;&#x8981;&#x7684;&#x4F9D;&#x8D56;"></a>5. &#x5B89;&#x88C5;<code>ant-design-pro</code>&#x9700;&#x8981;&#x7684;&#x4F9D;&#x8D56;</h4><p>&#x4EE5;&#x4E0B;&#x662F;<code>ant-design-pro</code>&#x9700;&#x8981;&#x7684;&#x4F9D;&#x8D56;&#xFF1A;<br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&quot;antd&quot;: &quot;3.0.0-beta.5&quot;,</span><br><span class="line">&quot;classnames&quot;: &quot;^2.2.5&quot;,</span><br><span class="line">&quot;dva&quot;: &quot;2.1.0-beta.3&quot;,</span><br><span class="line">&quot;history&quot;: &quot;^4.7.2&quot;,</span><br><span class="line">&quot;less&quot;: &quot;^2.7.3&quot;,</span><br><span class="line">&quot;lodash&quot;: &quot;^4.17.4&quot;,</span><br><span class="line">&quot;lodash-decorators&quot;: &quot;^4.5.0&quot;,</span><br><span class="line">&quot;lodash.clonedeep&quot;: &quot;^4.5.0&quot;,</span><br><span class="line">&quot;moment&quot;: &quot;^2.19.1&quot;,</span><br><span class="line">&quot;numeral&quot;: &quot;^2.0.6&quot;,</span><br><span class="line">&quot;postcss-less&quot;: &quot;^1.1.1&quot;,</span><br><span class="line">&quot;qs&quot;: &quot;^6.5.1&quot;,</span><br><span class="line">&quot;react-container-query&quot;: &quot;^0.9.1&quot;,</span><br><span class="line">&quot;react-document-title&quot;: &quot;^2.0.3&quot;,</span><br><span class="line">&quot;react-fittext&quot;: &quot;^1.0.0&quot;,</span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x5B89;&#x88C5;&#xFF1A;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add xxxx</span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x6CE8;&#x610F;&#xFF0C;&#x6709;&#x4E9B;&#x4E8B;prerelease&#x7248;&#x672C;&#xFF0C;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x7279;&#x5B9A;&#x7248;&#x672C;&#x5B89;&#x88C5;&#xFF0C;&#x6BD4;&#x5982;&#xFF1A;<code>antd</code>&#x548C;<code>dva</code>&#x3002;</p><p>&#x4F7F;&#x7528;beta&#x7248;&#x672C;&#x7684;&#x539F;&#x56E0;&#x5982;&#x4E0B;&#xFF1A;<br><code>atnd</code>&#xFF1A;<code>ant-design-pro</code>&#x4EE5;3.x&#x4E3A;&#x57FA;&#x7840;&#x6784;&#x5EFA;<br><code>dva</code>: <code>dva</code>&#x7684;<code>2.1.0-beta</code>&#x7248;&#x672C;&#x4FEE;&#x590D;&#x4E86;&#x4E00;&#x4E2A;<code>import</code>&#x7684;issue&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;<code>2.0.4</code>&#x7248;&#x672C;&#xFF0C;&#x6211;&#x4EEC;&#x7684;&#x9879;&#x76EE;&#x5C06;&#x65E0;&#x6CD5;&#x542F;&#x52A8;&#x3002;</p><h4 id="6-&#x8FC1;&#x79FB;ant-design-pro&#x4EE3;&#x7801;"><a href="#6-&#x8FC1;&#x79FB;ant-design-pro&#x4EE3;&#x7801;" class="headerlink" title="6. &#x8FC1;&#x79FB;ant-design-pro&#x4EE3;&#x7801;"></a>6. &#x8FC1;&#x79FB;<code>ant-design-pro</code>&#x4EE3;&#x7801;</h4><p>&#x5230;&#x4E86;&#x6BD4;&#x8F83;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x4E2A;&#x6B65;&#x9AA4;&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x6B65;&#x9AA4;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x5C06;<code>ant-design-pro</code>&#x7684;&#x4EE3;&#x7801;&#x8FC1;&#x79FB;&#x81F3;&#x6211;&#x4EEC;&#x7684;&#x9879;&#x76EE;&#x3002;</p><p>&#x5728;&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x5206;&#x4E3A;&#x51E0;&#x4E2A;&#x5C0F;&#x6B65;&#x9AA4;&#x8FDB;&#x884C;&#xFF1A;</p><ul><li>&#x5220;&#x9664;&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x9879;&#x76EE;&#x7684;<code>src</code>&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x6240;&#x6709;&#x5185;&#x5BB9;</li><li>&#x5C06;<code>src</code>&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x5185;&#x5BB9;&#x8FC1;&#x79FB;&#x81F3;&#x6211;&#x4EEC;&#x9879;&#x76EE;&#x7684;<code>src</code>&#x6587;&#x4EF6;&#x5939;&#x4E0B;</li><li><p>&#x4FEE;&#x6539;<code>/public/index.html</code>&#x6587;&#x4EF6;&#xFF0C;&#x5C06;<code>g2</code>&#x56FE;&#x6807;&#x7EC4;&#x4EF6;&#x9759;&#x6001;&#x5BFC;&#x5165;&#xFF1A;</p><figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://gw.alipayobjects.com/as/g/??datavis/g2/2.3.12/index.js,datavis/g-cloud/1.0.2/index.js,datavis/g2-plugin-slider/1.2.1/slider.js&quot;</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li><li><p>&#x5B89;&#x88C5;<code>react-fetch-mock</code>&#x66FF;&#x4EE3;<code>rodhog</code>&#x7684;<code>mock</code>&#xFF1A;</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add react-fetch-mock --dev</span><br></pre></td></tr></tbody></table></figure></li></ul><p>&#x521B;&#x5EFA;<code>/src/__mocks__</code>&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;<code>ant-design-pro</code>&#x6839;&#x8DEF;&#x5F84;&#x4E0B;<code>mock</code>&#x6587;&#x4EF6;&#x5939;&#x5185;&#x5BB9;&#x5168;&#x90E8;&#x8FC1;&#x79FB;&#x81F3;<code>/src/__mocks__</code>&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x3002;</p><p>&#x5728;<code>/src/__mocks__</code>&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x65B0;&#x5EFA;<code>index.js</code>&#x6587;&#x4EF6;&#xFF1A;<br>&#x590D;&#x5236;<code>.rodhog.mock.js</code>&#x5185;&#x5BB9;&#xFF0C;&#x5E76;&#x4FEE;&#x6539;&#x4E3A;&#xFF1A;<br></p><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { Mock } <span class="keyword">from</span> <span class="string">&apos;react-fetch-mock&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> { getRule, postRule } <span class="keyword">from</span> <span class="string">&apos;./rule&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> { getActivities, getNotice, getFakeList } <span class="keyword">from</span> <span class="string">&apos;./api&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> { getFakeChartData } <span class="keyword">from</span> <span class="string">&apos;./chart&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> { imgMap } <span class="keyword">from</span> <span class="string">&apos;./utils&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> { getProfileBasicData } <span class="keyword">from</span> <span class="string">&apos;./profile&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> { getProfileAdvancedData } <span class="keyword">from</span> <span class="string">&apos;./profile&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> { getNotices } <span class="keyword">from</span> <span class="string">&apos;./notices&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  <span class="comment">// &#x652F;&#x6301;&#x503C;&#x4E3A; Object &#x548C; Array</span></span><br><span class="line">  <span class="string">&apos;GET /api/currentUser&apos;</span>: <span class="function"><span class="params">()</span> =&gt;</span> {</span><br><span class="line">    <span class="keyword">return</span> {</span><br><span class="line">      name: <span class="string">&apos;Serati Ma&apos;</span>,</span><br><span class="line">      avatar: <span class="string">&apos;https://gw.alipayobjects.com/zos/rmsportal/dRFVcIqZOYPcSNrlJsqQ.png&apos;</span>,</span><br><span class="line">      userid: <span class="string">&apos;00000001&apos;</span>,</span><br><span class="line">      notifyCount: <span class="number">12</span>,</span><br><span class="line">    }</span><br><span class="line">  },</span><br><span class="line">  <span class="comment">// GET POST &#x53EF;&#x7701;&#x7565;</span></span><br><span class="line">  <span class="string">&apos;GET /api/users&apos;</span>: <span class="function"><span class="params">()</span> =&gt;</span> {</span><br><span class="line">    <span class="keyword">return</span> [{</span><br><span class="line">      key: <span class="string">&apos;1&apos;</span>,</span><br><span class="line">      name: <span class="string">&apos;John Brown&apos;</span>,</span><br><span class="line">      age: <span class="number">32</span>,</span><br><span class="line">      address: <span class="string">&apos;New York No. 1 Lake Park&apos;</span>,</span><br><span class="line">    }, {</span><br><span class="line">      key: <span class="string">&apos;2&apos;</span>,</span><br><span class="line">      name: <span class="string">&apos;Jim Green&apos;</span>,</span><br><span class="line">      age: <span class="number">42</span>,</span><br><span class="line">      address: <span class="string">&apos;London No. 1 Lake Park&apos;</span>,</span><br><span class="line">    }, {</span><br><span class="line">      key: <span class="string">&apos;3&apos;</span>,</span><br><span class="line">      name: <span class="string">&apos;Joe Black&apos;</span>,</span><br><span class="line">      age: <span class="number">32</span>,</span><br><span class="line">      address: <span class="string">&apos;Sidney No. 1 Lake Park&apos;</span>,</span><br><span class="line">    }]</span><br><span class="line">  },</span><br><span class="line">  <span class="string">&apos;GET /api/project/notice&apos;</span>: <span class="function"><span class="params">()</span> =&gt;</span> getNotice,</span><br><span class="line">  <span class="string">&apos;GET /api/activities&apos;</span>: <span class="function"><span class="params">()</span> =&gt;</span> getActivities,</span><br><span class="line">  <span class="string">&apos;GET /api/rule&apos;</span>: getRule,</span><br><span class="line">  <span class="string">&apos;POST /api/rule&apos;</span>: <span class="function">(<span class="params">obj</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">return</span> postRule({</span><br><span class="line">      ...obj, <span class="attr">urlparams</span>: {</span><br><span class="line">        pageSize: {</span><br><span class="line">          desc: <span class="string">&apos;&#x5206;&#x9875;&apos;</span>,</span><br><span class="line">          exp: <span class="number">2</span>,</span><br><span class="line">        },</span><br><span class="line">      }</span><br><span class="line">    });</span><br><span class="line">  },</span><br><span class="line">  <span class="string">&apos;POST /api/forms&apos;</span>: <span class="function"><span class="params">()</span> =&gt;</span> {</span><br><span class="line">    <span class="keyword">return</span> {};</span><br><span class="line">  },</span><br><span class="line">  <span class="string">&apos;GET /api/tags&apos;</span>: <span class="function"><span class="params">()</span> =&gt;</span> {</span><br><span class="line">    <span class="keyword">return</span> Mock.mock({</span><br><span class="line">      <span class="string">&apos;list|100&apos;</span>: [{ <span class="attr">name</span>: <span class="string">&apos;@city&apos;</span>, <span class="string">&apos;value|1-100&apos;</span>: <span class="number">150</span>, <span class="string">&apos;type|0-2&apos;</span>: <span class="number">1</span> }]</span><br><span class="line">    }).list;</span><br><span class="line">  },</span><br><span class="line">  <span class="string">&apos;GET /api/fake_list&apos;</span>: getFakeList,</span><br><span class="line">  <span class="string">&apos;GET /api/fake_chart_data&apos;</span>: <span class="function"><span class="params">()</span> =&gt;</span> getFakeChartData,</span><br><span class="line">  <span class="string">&apos;GET /api/profile/basic&apos;</span>: <span class="function"><span class="params">()</span> =&gt;</span> getProfileBasicData,</span><br><span class="line">  <span class="string">&apos;GET /api/profile/advanced&apos;</span>: <span class="function"><span class="params">()</span> =&gt;</span> getProfileAdvancedData,</span><br><span class="line">  <span class="string">&apos;POST /api/login/account&apos;</span>: <span class="function">(<span class="params">{ params }</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> { password, userName } = params;</span><br><span class="line">    <span class="keyword">return</span> {</span><br><span class="line">      status: password === <span class="string">&apos;888888&apos;</span> &amp;&amp; userName === <span class="string">&apos;admin&apos;</span> ? <span class="number">200</span> : <span class="number">401</span>,</span><br><span class="line">      type: <span class="string">&apos;account&apos;</span>,</span><br><span class="line">    };</span><br><span class="line">  },</span><br><span class="line">  <span class="string">&apos;POST /api/login/mobile&apos;</span>: <span class="function"><span class="params">()</span> =&gt;</span> {</span><br><span class="line">    <span class="keyword">return</span> {</span><br><span class="line">      status: <span class="number">200</span>,</span><br><span class="line">      type: <span class="string">&apos;mobile&apos;</span></span><br><span class="line">    };</span><br><span class="line">  },</span><br><span class="line">  <span class="string">&apos;POST /api/register&apos;</span>: <span class="function"><span class="params">()</span> =&gt;</span> {</span><br><span class="line">    <span class="keyword">return</span> {};</span><br><span class="line">  },</span><br><span class="line">  <span class="string">&apos;GET /api/notices&apos;</span>: getNotices,</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><p>&#x540C;&#x65F6;&#xFF0C;<code>__mocks__</code>&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x5176;&#x4ED6;&#x975E;<code>index.js</code>&#x6587;&#x4EF6;&#xFF0C;&#x9700;&#x8981;&#x6839;&#x636E;<code>react-fetch-mock</code>&#x89C4;&#x5219;&#x8FDB;&#x884C;&#x4FEE;&#x6539;&#x3002;&#x5177;&#x4F53;&#x7528;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#xFF1A;<a href="https://github.com/WhatAKitty/react-fetch-mock&#x3002;&#x6539;&#x9020;&#x540E;&#x7684;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x6B64;&#x67E5;&#x770B;&#xFF1A;https://github.com/WhatAKitty/react-script-antd-pro/tree/master/src/__mocks_" target="_blank" rel="noopener">https://github.com/WhatAKitty/react-fetch-mock&#x3002;&#x6539;&#x9020;&#x540E;&#x7684;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x6B64;&#x67E5;&#x770B;&#xFF1A;https://github.com/WhatAKitty/react-script-antd-pro/tree/master/src/__mocks_</a>_</p><h4 id="7-&#x5B8C;&#x6210;"><a href="#7-&#x5B8C;&#x6210;" class="headerlink" title="7. &#x5B8C;&#x6210;"></a>7. &#x5B8C;&#x6210;</h4><p>&#x6539;&#x9020;&#x57FA;&#x672C;&#x5B8C;&#x6210;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0B;&#x9762;&#x547D;&#x4EE4;&#x6765;&#x67E5;&#x770B;&#x5177;&#x4F53;&#x6548;&#x679C;&#xFF1A;</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn start</span><br></pre></td></tr></tbody></table></figure><h3 id="&#x7ED3;&#x675F;&#x8BED;"><a href="#&#x7ED3;&#x675F;&#x8BED;" class="headerlink" title="&#x7ED3;&#x675F;&#x8BED;"></a>&#x7ED3;&#x675F;&#x8BED;</h3><p>&#x901A;&#x8FC7;&#x4EE5;&#x4E0A;&#xFF0C;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x6539;&#x9020;&#x3002;<br>&#x5982;&#x679C;&#x5ACC;&#x81EA;&#x5DF1;&#x6539;&#x9020;&#x9EBB;&#x70E6;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x7684;&#x7248;&#x672C;&#xFF1A;<a href="https://github.com/WhatAKitty/react-script-antd-pro&#xFF0C;&#x5E76;&#x4E14;&#x4F1A;&#x6839;&#x636E;`ant-design-pro`&#x8FDB;&#x884C;&#x6BCF;&#x5929;&#x66F4;&#x65B0;&#x3002;" target="_blank" rel="noopener">https://github.com/WhatAKitty/react-script-antd-pro&#xFF0C;&#x5E76;&#x4E14;&#x4F1A;&#x6839;&#x636E;`ant-design-pro`&#x8FDB;&#x884C;&#x6BCF;&#x5929;&#x66F4;&#x65B0;&#x3002;</a></p><h4 id="&#x6269;&#x5C55;"><a href="#&#x6269;&#x5C55;" class="headerlink" title="&#x6269;&#x5C55;"></a>&#x6269;&#x5C55;</h4><p>&#x6709;&#x7A7A;&#x7684;&#x8BDD;&#xFF0C;&#x4F1A;&#x5C06;&#x52A8;&#x6001;&#x8DEF;&#x7531;&#x7684;&#x6539;&#x9020;&#x8FC7;&#x7A0B;&#x63CF;&#x8FF0;&#x52A0;&#x5165;&#x3002;&#x73B0;&#x5728;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0A;&#x9762;&#x90A3;&#x4E2A;&#x5B8C;&#x6210;&#x7248;&#x672C;&#x91CC;&#x9762;&#x67E5;&#x770B;&#x52A8;&#x6001;&#x8DEF;&#x7531;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF0C;&#x5728;&#x90A3;&#x4E2A;&#x7248;&#x672C;&#x4E2D;&#xFF0C;&#x52A8;&#x6001;&#x8DEF;&#x7531;&#x5DF2;&#x7ECF;&#x52A0;&#x5165;&#x3002;</p><script>document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });</script></div></div><div class="article-copyright"><div class="copyright"><p><span>本文标题:</span><a href="/以react-script重构antd-pro.html">以react-script重构antd-pro</a></p><p><span>文章作者:</span><a href="/" title="访问 WhatAKitty 的个人博客">WhatAKitty</a></p><p><span>发布时间:</span>2017年11月08日 - 17时48分</p><p><span>最后更新:</span>2017年11月11日 - 17时48分</p><p><span>原始链接:</span><a href="/以react-script重构antd-pro.html" title="以react-script重构antd-pro">https://xuqiang.me/以react-script重构antd-pro.html</a> <span class="btn" data-clipboard-text="原文: https://xuqiang.me/以react-script重构antd-pro.html　　作者: WhatAKitty" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。</p></div><br><br><style type="text/css">.copyright p .btn{margin-left:1em}.copyright:hover p .btn::after{content:"复制"}.copyright p .btn:hover{color:gray;cursor:pointer}</style></div><div class="article-footer"><div class="article-meta pull-left"><span class="post-categories"><i class="icon-categories"></i> <a href="/categories/ReactJS/">ReactJS</a> </span><span class="post-tags"><i class="icon-tags"></i> <a href="/tags/react/">react</a><a href="/tags/react-script/">react-script</a><a href="/tags/antd/">antd</a><a href="/tags/create-react-app/">create-react-app</a></span></div><div class="article-meta pull-right"><span style="display:inline-block;width:83px"><a style="float:left;text-decoration:none" target="_blank" href="https://www.banquanyin.com/u/101709260007755"><img src="https://s1.banquanyin.com/c/icon-yin-24.png" title="更多授权" style="width:inherit"> </a><a target="_blank" href="https://101709260007755.bqy.mobi"><img src="https://s1.banquanyin.com/c/icon-auth-cr-24.png" title="获取授权" style="width:inherit"></a></span></div></div><div style="text-align:center;margin-top:80px"><div id="cyReward" role="cylabs" data-use="reward" sid="035f83b1fd389d609246f2b960e53f1e" cid="1"></div></div></article><div id="SOHUCS" sid="035f83b1fd389d609246f2b960e53f1e"></div><script type="text/javascript">!function(){var e,t,n,a="cytdcyLLd",c="1243e90ae1a56c027241ecf5b99daeda";(window.innerWidth||document.documentElement.clientWidth)<960?window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id='+a+"&conf="+c+'"><\/script>'):(e=function(){window.changyan.api.config({appid:a,conf:c})},t=document.getElementsByTagName("head")[0]||document.head||document.documentElement,(n=document.createElement("script")).setAttribute("type","text/javascript"),n.setAttribute("charset","UTF-8"),n.setAttribute("src","https://changyan.sohu.com/upload/changyan.js"),window.attachEvent?n.onreadystatechange=function(){var t=n.readyState;"loaded"!==t&&"complete"!==t||(n.onreadystatechange=null,e())}:n.onload=e,t.appendChild(n))}()</script><script type="text/javascript" charset="utf-8" src="https://changyan.itc.cn/js/lib/jquery.js"></script><script type="text/javascript" charset="utf-8" src="https://changyan.sohu.com/js/changyan.labs.https.js?appid=cytdcyLLd"></script><script src="https://cdn.staticfile.org/viz.js/1.8.2/viz.js"></script><script>String.prototype.replaceAll = function(search, replacement) {
      var target = this;
      return target.split(search).join(replacement);
    };

    let vizObjects = document.querySelectorAll('.graphviz')

    for (let item of vizObjects) {
      let svg = undefined
      try {
        svg = Viz(item.textContent.replaceAll('–', '--'), 'svg')
      } catch(e) {
        svg = `<pre class="error">${e}</pre>`
      }
      item.outerHTML = svg
    }</script></main><footer class="site-footer"><script async src="//static.xuqiang.me/busuanzi.pure.mini.js"></script><p class="site-info">Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a><br>&copy; 2019 WhatAKitty | <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span><br><a href="https://blog.whatakitty.com">浙ICP备15019585号</a> <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33010602008839" style="display:block;line-height:20px"><span style="display:inline-block;line-height:20px;vertical-align:middle"><img src="https://static.xuqiang.me/public/images/beian.png" style="width:20px;height:20px"></span><span style="display:inline-block;height:20px;line-height:20px;margin:0 0 0 5px">浙公网安备 33010602008839号</span></a></p></footer><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?1d4c4cd810512d2fddb7187b7939389a";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></div></div></body></html>
