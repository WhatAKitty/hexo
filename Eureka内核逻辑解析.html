<!DOCTYPE HTML><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Eureka内核逻辑解析 | WhatAKitty Daily | A Programmer&#39;s Daily Record</title><meta name="author" content="WhatAKitty"><meta name="description" content="Just A Simple Programmer."><meta name="keywords" content="java,eureka,cloud,HA,CAP,AP,Spring Cloud,Blog, SSL, Nodejs, DevOps, Spring, Spring Cloud, Jenkins, Docker, JIRA, CI"><meta id="viewport" name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta property="og:title" content="Eureka内核逻辑解析"><meta property="og:site_name" content="WhatAKitty Daily"><meta property="og:image" content="/favicon.ico"><link href="/favicon.ico" rel="icon"><link rel="alternate" href="/atom.xml" title="WhatAKitty Daily" type="application/atom+xml"><link rel="stylesheet" href="/css/style.css" media="screen" type="text/css"></head><body><div class="blog"><div class="content"><header><div class="site-branding"><h1 class="site-title"><a href="/">WhatAKitty Daily</a></h1><p class="site-description">A Programmer&#39;s Daily Record</p></div><nav class="site-navigation"><ul><li><a href="/">主页</a></li><li><a href="/archives">归档</a></li><li><a href="/projects">项目</a></li><li><a href="/categories/JavaSources">Java Sources</a></li><li><a href="/categories/Java/Spring/SpringSources">Spring Sources</a></li><li><a href="/atom.xml">订阅</a></li></ul></nav></header><main class="site-main posts-loop"><article><h3 class="article-title"><span>Eureka内核逻辑解析</span></h3><div class="article-top-meta"><span class="posted-on"><a href="/Eureka内核逻辑解析.html" rel="bookmark">WhatAKitty &emsp; <time class="entry-date published" datetime="2020-06-29T17:23:36.000Z">2020-06-30 </time>&emsp; <span id="busuanzi_container_page_pv">阅读次数<span id="busuanzi_value_page_pv">loading...</span></span></a></span></div><div class="article-content"><div class="entry"><h3 id="&#x6982;&#x89C8;"><a href="#&#x6982;&#x89C8;" class="headerlink" title="&#x6982;&#x89C8;"></a>&#x6982;&#x89C8;</h3><p><img src="https://static.xuqiang.me/public/images/161317.jpg" alt="Eureka&#x9AD8;&#x53EF;&#x7528;&#x67B6;&#x6784;"></p><p>&#x672C;&#x6587;&#x5206;&#x4EE5;&#x4E0B;&#x51E0;&#x70B9;&#xFF1A;</p><ol><li>Eureka&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x5B9E;&#x73B0;<br>a. eureka&#x5BA2;&#x6237;&#x7AEF;&#x4E0E;&#x670D;&#x52A1;&#x7AEF;&#x901A;&#x8BAF;&#x673A;&#x5236;<br>b. eureka&#x670D;&#x52A1;&#x7AEF;&#x4E0E;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x8282;&#x70B9;&#x7684;&#x901A;&#x8BAF;<br>c. eureka&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x81EA;&#x6211;&#x4FDD;&#x62A4;&#x673A;&#x5236;</li><li>Eureka&#x4E0E;ZK&#x7684;&#x6BD4;&#x8F83;<br>a. CAP&#x6A21;&#x578B;<br>b. &#x4F7F;&#x7528;&#x573A;&#x666F;</li></ol><h3 id="Eureka&#x9AD8;&#x53EF;&#x7528;&#x5B9E;&#x73B0;"><a href="#Eureka&#x9AD8;&#x53EF;&#x7528;&#x5B9E;&#x73B0;" class="headerlink" title="Eureka&#x9AD8;&#x53EF;&#x7528;&#x5B9E;&#x73B0;"></a>Eureka&#x9AD8;&#x53EF;&#x7528;&#x5B9E;&#x73B0;</h3><p>Eureka&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x4E09;&#x70B9;&#x5B9E;&#x73B0;&#xFF1A;<br>a. eureka&#x5BA2;&#x6237;&#x7AEF;&#x4E0E;&#x670D;&#x52A1;&#x7AEF;&#x901A;&#x8BAF;&#x673A;&#x5236;<br>b. eureka&#x670D;&#x52A1;&#x7AEF;&#x4E0E;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x8282;&#x70B9;&#x7684;&#x901A;&#x8BAF;<br>c. eureka&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x81EA;&#x6211;&#x4FDD;&#x62A4;&#x673A;&#x5236;</p><a id="more"></a><h4 id="eureka&#x5BA2;&#x6237;&#x7AEF;&#x4E0E;&#x670D;&#x52A1;&#x7AEF;&#x901A;&#x8BAF;&#x673A;&#x5236;"><a href="#eureka&#x5BA2;&#x6237;&#x7AEF;&#x4E0E;&#x670D;&#x52A1;&#x7AEF;&#x901A;&#x8BAF;&#x673A;&#x5236;" class="headerlink" title="eureka&#x5BA2;&#x6237;&#x7AEF;&#x4E0E;&#x670D;&#x52A1;&#x7AEF;&#x901A;&#x8BAF;&#x673A;&#x5236;"></a>eureka&#x5BA2;&#x6237;&#x7AEF;&#x4E0E;&#x670D;&#x52A1;&#x7AEF;&#x901A;&#x8BAF;&#x673A;&#x5236;</h4><p>&#x53EF;&#x4EE5;&#x770B;&#x4E0B;&#x5BA2;&#x6237;&#x7AEF;&#x4E0E;Eureka&#x670D;&#x52A1;&#x7AEF;&#x4E4B;&#x95F4;&#x7684;&#x901A;&#x8BAF;&#x7684;&#x6982;&#x8FF0;&#x6D41;&#x7A0B;&#xFF1A;</p><p><img src="https://static.xuqiang.me/public/images/152011.jpg" alt="&#x901A;&#x8BAF;"></p><p>&#x540C;&#x65F6;&#x4E3A;&#x4E86;&#x66F4;&#x597D;&#x7684;&#x8BF4;&#x660E;&#x9AD8;&#x53EF;&#x7528;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x5728;&#x8FD9;&#x91CC;&#x5927;&#x6982;&#x63CF;&#x8FF0;&#x4E00;&#x4E0B;Eureka&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x5B58;&#x50A8;&#x7ED3;&#x6784;&#xFF1A;</p><p><img src="https://static.xuqiang.me/public/images/160441.jpg" alt="&#x5B58;&#x50A8;&#x7ED3;&#x6784;"></p><h5 id="&#x670D;&#x52A1;&#x6CE8;&#x518C;"><a href="#&#x670D;&#x52A1;&#x6CE8;&#x518C;" class="headerlink" title="&#x670D;&#x52A1;&#x6CE8;&#x518C;"></a>&#x670D;&#x52A1;&#x6CE8;&#x518C;</h5><ol><li><p>&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;<code>POST /eureka/v2/apps</code>&#x63A5;&#x53E3;&#xFF0C;&#x5C06;&#x5BA2;&#x6237;&#x7AEF;&#x7684;&#x670D;&#x52A1;&#x4FE1;&#x606F;&#x4E0A;&#x4F20;<br><code>PeerAwareInstanceRegistryImpl.java</code> 399&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> leaseDuration = Lease.DEFAULT_DURATION_IN_SECS;</span><br><span class="line"><span class="keyword">if</span> (info.getLeaseInfo() != <span class="keyword">null</span> &amp;&amp; info.getLeaseInfo().getDurationInSecs() &gt; <span class="number">0</span>) {</span><br><span class="line">    leaseDuration = info.getLeaseInfo().getDurationInSecs();</span><br><span class="line">}</span><br><span class="line"><span class="comment">// &#x672C;&#x5730;&#x6CE8;&#x518C;</span></span><br><span class="line"><span class="keyword">super</span>.register(info, leaseDuration, isReplication);</span><br><span class="line"><span class="comment">// &#x534F;&#x540C;&#x5176;&#x4ED6;eureka&#x670D;&#x52A1;&#x8282;&#x70B9;&#x540C;&#x6B65;&#x6CE8;&#x518C;</span></span><br><span class="line">replicateToPeers(Action.Register, info.getAppName(), info.getId(), info, <span class="keyword">null</span>, isReplication);</span><br></pre></td></tr></tbody></table></figure></li><li><p>Eureka&#x670D;&#x52A1;&#x7AEF;&#x5C06;&#x5BA2;&#x6237;&#x7AEF;&#x4FE1;&#x606F;&#x4FDD;&#x5B58;&#x81F3;<code>Registry</code>&#x6CE8;&#x518C;&#x4FE1;&#x606F;&#x8F7D;&#x4F53;&#x5185;</p></li><li><p>&#x5C06;&#x6B64;&#x6B21;&#x6DFB;&#x52A0;&#x53D8;&#x66F4;&#x589E;&#x52A0;&#x5230;&#x53D8;&#x66F4;&#x961F;&#x5217;<br><code>AbstractInstanceRegistry.java</code> 194&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(InstanceInfo registrant, <span class="keyword">int</span> leaseDuration, <span class="keyword">boolean</span> isReplication)</span> </span>{</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        <span class="comment">// &#x8BFB;&#x9501;</span></span><br><span class="line">        read.lock();</span><br><span class="line">        <span class="comment">// &#x5B58;&#x50A8;&#x672C;&#x6B21;&#x6CE8;&#x518C;&#x4FE1;&#x606F;&#xFF08;appName -&gt; instanceId -&gt; instanceInfo&#xFF09;</span></span><br><span class="line">        Map&lt;String, Lease&lt;InstanceInfo&gt;&gt; gMap = registry.get(registrant.getAppName());</span><br><span class="line">        REGISTER.increment(isReplication);</span><br><span class="line">        <span class="keyword">if</span> (gMap == <span class="keyword">null</span>) {</span><br><span class="line">            <span class="keyword">final</span> ConcurrentHashMap&lt;String, Lease&lt;InstanceInfo&gt;&gt; gNewMap = <span class="keyword">new</span> ConcurrentHashMap&lt;String, Lease&lt;InstanceInfo&gt;&gt;();</span><br><span class="line">            gMap = registry.putIfAbsent(registrant.getAppName(), gNewMap);</span><br><span class="line">            <span class="keyword">if</span> (gMap == <span class="keyword">null</span>) {</span><br><span class="line">                gMap = gNewMap;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">// ...&#x5176;&#x4ED6;&#x903B;&#x8F91;</span></span><br><span class="line">        <span class="comment">// &#x5C06;&#x672C;&#x6B21;&#x6DFB;&#x52A0;&#x53D8;&#x66F4;&#x52A0;&#x5165;&#x6700;&#x8FD1;&#x53D8;&#x66F4;&#x961F;&#x5217;&#x5185;</span></span><br><span class="line">        recentlyChangedQueue.add(<span class="keyword">new</span> RecentlyChangedItem(lease));</span><br><span class="line">        <span class="comment">// &#x8BBE;&#x7F6E;&#x79DF;&#x7EA6;&#x7684;&#x4E0A;&#x4E00;&#x6B21;&#x66F4;&#x65B0;&#x65F6;&#x95F4;</span></span><br><span class="line">        registrant.setLastUpdatedTimestamp();   </span><br><span class="line">        <span class="comment">// &#x6267;&#x884C;&#x7F13;&#x5B58;&#x6E05;&#x7A7A;</span></span><br><span class="line">        invalidateCache(registrant.getAppName(), registrant.getVIPAddress(), registrant.getSecureVipAddress());</span><br><span class="line">    } <span class="keyword">finally</span> {</span><br><span class="line">        <span class="comment">// &#x8BFB;&#x9501;&#x89E3;&#x9501;</span></span><br><span class="line">        read.unlock();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>&#x6E05;&#x7A7A;&#x8BFB;&#x5199;&#x7F13;&#x5B58;&#xFF08;&#x5148;&#x6E05;&#x7406;APP&#x3001;&#x518D;&#x6E05;&#x7406;ALL_APPS&#x3001;&#x6700;&#x540E;&#x6E05;&#x7406;ALL_APPS_DELTA&#xFF09;<br><code>ResponseCacheImpl.java</code> 251&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invalidate</span><span class="params">(String appName, @Nullable String vipAddress, @Nullable String secureVipAddress)</span> </span>{</span><br><span class="line">    <span class="keyword">for</span> (Key.KeyType type : Key.KeyType.values()) {</span><br><span class="line">        <span class="keyword">for</span> (Version v : Version.values()) {</span><br><span class="line">            <span class="comment">// &#x5220;&#x9664;appName&#x672C;&#x8EAB;&#x7684;&#x7F13;&#x5B58;</span></span><br><span class="line">            <span class="comment">// &#x5220;&#x9664;ALL_APPS&#x7684;&#x7F13;&#x5B58;</span></span><br><span class="line">            <span class="comment">// &#x5220;&#x9664;ALL_APPS_DELTA&#x7684;&#x7F13;&#x5B58;</span></span><br><span class="line">            invalidate(</span><br><span class="line">                    <span class="keyword">new</span> Key(Key.EntityType.Application, appName, type, v, EurekaAccept.full),</span><br><span class="line">                    <span class="keyword">new</span> Key(Key.EntityType.Application, appName, type, v, EurekaAccept.compact),</span><br><span class="line">                    <span class="keyword">new</span> Key(Key.EntityType.Application, ALL_APPS, type, v, EurekaAccept.full),</span><br><span class="line">                    <span class="keyword">new</span> Key(Key.EntityType.Application, ALL_APPS, type, v, EurekaAccept.compact),</span><br><span class="line">                    <span class="keyword">new</span> Key(Key.EntityType.Application, ALL_APPS_DELTA, type, v, EurekaAccept.full),</span><br><span class="line">                    <span class="keyword">new</span> Key(Key.EntityType.Application, ALL_APPS_DELTA, type, v, EurekaAccept.compact)</span><br><span class="line">            );</span><br><span class="line">            <span class="comment">// &#x5B58;&#x5728;&#x865A;&#x62DF;&#x5730;&#x5740;&#x540D;&#x79F0;&#x7684;&#xFF0C;&#x5220;&#x9664;&#x865A;&#x62DF;&#x5730;&#x5740;&#x4E3A;key&#x7684;&#x7F13;&#x5B58;</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != vipAddress) {</span><br><span class="line">                invalidate(<span class="keyword">new</span> Key(Key.EntityType.VIP, vipAddress, type, v, EurekaAccept.full));</span><br><span class="line">            }</span><br><span class="line">            <span class="comment">// &#x5B58;&#x5728;&#x5B89;&#x5168;&#x865A;&#x62DF;&#x5730;&#x5740;&#x540D;&#x79F0;&#x7684;&#xFF0C;&#x5220;&#x9664;&#x5B89;&#x5168;&#x865A;&#x62DF;&#x5730;&#x5740;&#x4E3A;key&#x7684;&#x7F13;&#x5B58;</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">null</span> != secureVipAddress) {</span><br><span class="line">                invalidate(<span class="keyword">new</span> Key(Key.EntityType.SVIP, secureVipAddress, type, v, EurekaAccept.full));</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><p><code>ResponseCacheImpl.java</code> 277&#x884C;&#xFF1A;<br></p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invalidate</span><span class="params">(Key... keys)</span> </span>{</span><br><span class="line">    <span class="keyword">for</span> (Key key : keys) {</span><br><span class="line">        <span class="comment">// Guava&#x7F13;&#x5B58;&#x5BF9;key&#x8BBE;&#x7F6E;&#x65E0;&#x6548;</span></span><br><span class="line">        readWriteCacheMap.invalidate(key);</span><br><span class="line">        Collection&lt;Key&gt; keysWithRegions = regionSpecificKeys.get(key);</span><br><span class="line">        <span class="comment">// key&#x5173;&#x8054;&#x533A;&#x57DF;&#x7684;&#x7F13;&#x5B58;&#x65E0;&#x6548;&#x8BBE;&#x7F6E;</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p><ol start="5"><li><p>&#x5224;&#x65AD;&#x4E0D;&#x5B58;&#x5B58;&#x5728;&#x5176;&#x4ED6;eureka&#x670D;&#x52A1;&#x8282;&#x70B9;&#xFF0C;&#x6216;&#x8005;&#x672C;&#x6B21;&#x8BF7;&#x6C42;&#x4E3A;&#x540C;&#x6B65;&#x8BF7;&#x6C42;&#x5219;&#x5B8C;&#x6210;&#x6CE8;&#x518C;<br><code>PeerAwareInstanceRegistryImpl.java</code> 620&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (peerEurekaNodes == Collections.EMPTY_LIST || isReplication) {</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>&#x5426;&#x5219;&#xFF0C;&#x83B7;&#x53D6;&#x6240;&#x6709;&#x5176;&#x4ED6;&#x7684;&#x670D;&#x52A1;&#x8282;&#x70B9;&#xFF0C;&#x6392;&#x9664;&#x672C;&#x8EAB;&#x670D;&#x52A1;&#xFF0C;&#x5C06;&#x672C;&#x6B21;&#x6CE8;&#x518C;&#x540C;&#x6B65;&#x81F3;&#x5176;&#x4ED6;eureka&#x670D;&#x52A1;&#x8282;&#x70B9;<br><code>PeerAwareInstanceRegistryImpl.java</code> 624&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">final</span> PeerEurekaNode node : peerEurekaNodes.getPeerEurekaNodes()) {</span><br><span class="line">    <span class="comment">// &#x6392;&#x9664;&#x81EA;&#x8EAB;</span></span><br><span class="line">    <span class="keyword">if</span> (peerEurekaNodes.isThisMyUrl(node.getServiceUrl())) {</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// &#x540C;&#x6B65;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x8282;&#x70B9;</span></span><br><span class="line">    replicateInstanceActionsToPeers(action, appName, id, info, newStatus, node);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><h5 id="&#x670D;&#x52A1;&#x7EED;&#x7EA6;"><a href="#&#x670D;&#x52A1;&#x7EED;&#x7EA6;" class="headerlink" title="&#x670D;&#x52A1;&#x7EED;&#x7EA6;"></a>&#x670D;&#x52A1;&#x7EED;&#x7EA6;</h5><ol><li>&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;<code>PUT /eureka/v2/apps/{appId}</code></li><li>&#x6839;&#x636E;appName&#x83B7;&#x53D6;&#x79DF;&#x7EA6;</li><li>&#x66F4;&#x65B0;&#x79DF;&#x7EA6;</li><li>&#x540C;&#x6B65;&#x81F3;&#x5176;&#x4ED6;eureka&#x670D;&#x52A1;&#x8282;&#x70B9;</li></ol><p>&#x7EED;&#x7EA6;&#x7C7B;&#x4F3C;&#x5FC3;&#x8DF3;&#x673A;&#x5236;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x4F1A;&#x6309;&#x7167;&#x9ED8;&#x8BA4;&#x65F6;&#x95F4;&#x7684;30&#x79D2;&#x5B9A;&#x65F6;&#x505A;&#x4E00;&#x6B21;&#x7EED;&#x7EA6;&#xFF0C;&#x5982;&#x679C;&#x8D85;&#x8FC7;3&#x6B21;&#x6CA1;&#x6709;&#x6210;&#x529F;&#xFF0C;&#x5219;&#x670D;&#x52A1;&#x7AEF;&#x4F1A;&#x5C06;&#x8BE5;&#x5BA2;&#x6237;&#x7AEF;&#x5254;&#x9664;&#x3002;</p><h5 id="&#x670D;&#x52A1;&#x53D6;&#x6D88;&#x6CE8;&#x518C;"><a href="#&#x670D;&#x52A1;&#x53D6;&#x6D88;&#x6CE8;&#x518C;" class="headerlink" title="&#x670D;&#x52A1;&#x53D6;&#x6D88;&#x6CE8;&#x518C;"></a>&#x670D;&#x52A1;&#x53D6;&#x6D88;&#x6CE8;&#x518C;</h5><ol><li>&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;<code>DELETE /eureka/v2/apps/{appId}</code></li><li>&#x6839;&#x636E;appName&#x83B7;&#x53D6;&#x79DF;&#x7EA6;</li><li>&#x8BBE;&#x7F6E;&#x79DF;&#x7EA6;&#x8FC7;&#x671F;&#x65F6;&#x95F4;<code>evictionTimestamp</code>&#x4E3A;&#x5F53;&#x524D;&#x65F6;&#x95F4;</li><li>&#x5C06;&#x6B64;&#x6B21;&#x5220;&#x9664;&#x589E;&#x52A0;&#x5230;&#x53D8;&#x66F4;&#x961F;&#x5217;&#x4E2D;</li><li>&#x6E05;&#x7A7A;&#x8BFB;&#x5199;&#x7F13;&#x5B58;&#xFF08;&#x5148;&#x6E05;&#x7406;APP&#x3001;&#x518D;&#x6E05;&#x7406;ALL_APPS&#x3001;&#x6700;&#x540E;&#x6E05;&#x7406;ALL_APPS_DELTA&#xFF09;</li></ol><h5 id="&#x670D;&#x52A1;&#x5254;&#x9664;"><a href="#&#x670D;&#x52A1;&#x5254;&#x9664;" class="headerlink" title="&#x670D;&#x52A1;&#x5254;&#x9664;"></a>&#x670D;&#x52A1;&#x5254;&#x9664;</h5><ol><li><p>Eureka&#x670D;&#x52A1;&#x7AEF;&#x4F1A;&#x5728;&#x5185;&#x90E8;&#x4F1A;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;<code>Timer</code>&#x5B9A;&#x65F6;&#x5668;&#x7528;&#x4E8E;&#x5B9A;&#x65F6;&#x8C03;&#x5EA6;&#x5904;&#x7406;&#x5254;&#x9664;&#x4EFB;&#x52A1;&#xFF1B;&#x5254;&#x9664;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#x4E3A;<code>evictionIntervalTimerInMs</code><br><code>AbstractInstanceRegistry.java</code> 1212&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">postInit</span><span class="params">()</span> </span>{</span><br><span class="line">   <span class="comment">// ....</span></span><br><span class="line">   <span class="comment">// &#x8BBE;&#x7F6E;&#x65B0;&#x7684;&#x8FC7;&#x671F;&#x4EFB;&#x52A1;</span></span><br><span class="line">   evictionTaskRef.set(<span class="keyword">new</span> EvictionTask());</span><br><span class="line">   <span class="comment">// &#x4EFB;&#x52A1;&#x8C03;&#x5EA6;</span></span><br><span class="line">   evictionTimer.schedule(evictionTaskRef.get(),</span><br><span class="line">            serverConfig.getEvictionIntervalTimerInMs(),</span><br><span class="line">            serverConfig.getEvictionIntervalTimerInMs());</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>&#x5224;&#x65AD;&#x662F;&#x5426;&#x542F;&#x7528;&#x81EA;&#x6211;&#x4FDD;&#x62A4;&#xFF0C;&#x5982;&#x679C;&#x7981;&#x7528;&#xFF0C;&#x5219;&#x4E0D;&#x8FDB;&#x884C;&#x670D;&#x52A1;&#x5254;&#x9664;</p></li><li><p>&#x5224;&#x65AD; &#x4E0A;&#x4E00;&#x5206;&#x949F;&#x5B9E;&#x9645;&#x7684;&#x7EED;&#x7EA6;&#x6B21;&#x6570; &lt;= <code>numberOfRenewsPerMinThreshold</code>&#xFF0C;&#x5219;&#x4F1A;&#x89E6;&#x53D1;&#x81EA;&#x6211;&#x4FDD;&#x62A4;&#x673A;&#x5236;&#xFF0C;&#x505C;&#x6B62;&#x670D;&#x52A1;&#x5254;&#x9664;<br><code>PeerAwareInstanceRegistryImpl.java</code> 474&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &#x5224;&#x65AD;&#x81EA;&#x6211;&#x4FDD;&#x62A4;&#x662F;&#x5426;&#x7981;&#x7528;</span></span><br><span class="line"><span class="keyword">if</span> (!isSelfPreservationModeEnabled()) {</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// &#x81EA;&#x6211;&#x4FDD;&#x62A4;&#x673A;&#x5236;&#x9608;&#x503C;&#x5224;&#x65AD;</span></span><br><span class="line"><span class="keyword">return</span> numberOfRenewsPerMinThreshold &gt; <span class="number">0</span> &amp;&amp; getNumOfRenewsInLastMin() &gt; numberOfRenewsPerMinThreshold;</span><br></pre></td></tr></tbody></table></figure></li><li><p>&#x904D;&#x5386;<code>Registry</code>&#x5185;&#x6240;&#x6709;&#x7684;&#x79DF;&#x7EA6;&#x4FE1;&#x606F;&#xFF0C;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x79DF;&#x7EA6;&#x662F;&#x5426;&#x8FC7;&#x671F;</p></li><li><p>&#x5C06;&#x8FD9;&#x4E9B;&#x8FC7;&#x671F;&#x7684;&#x79DF;&#x7EA6;&#x653E;&#x7F6E;&#x5230;&#x4E00;&#x4E2A;&#x8FC7;&#x671F;&#x5217;&#x8868;&#x5185;<br><code>AbstractInstanceRegistry.java</code> 597&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Lease&lt;InstanceInfo&gt;&gt; expiredLeases = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="comment">// &#x904D;&#x5386;&#x79DF;&#x7EA6;</span></span><br><span class="line"><span class="keyword">for</span> (Entry&lt;String, Map&lt;String, Lease&lt;InstanceInfo&gt;&gt;&gt; groupEntry : registry.entrySet()) {</span><br><span class="line">   Map&lt;String, Lease&lt;InstanceInfo&gt;&gt; leaseMap = groupEntry.getValue();</span><br><span class="line">   <span class="keyword">if</span> (leaseMap != <span class="keyword">null</span>) {</span><br><span class="line">         <span class="keyword">for</span> (Entry&lt;String, Lease&lt;InstanceInfo&gt;&gt; leaseEntry : leaseMap.entrySet()) {</span><br><span class="line">            Lease&lt;InstanceInfo&gt; lease = leaseEntry.getValue();</span><br><span class="line">            <span class="comment">// &#x5224;&#x65AD;&#x79DF;&#x7EA6;&#x662F;&#x5426;&#x8FC7;&#x671F;</span></span><br><span class="line">            <span class="comment">// additionalLeaseMs&#x662F;&#x8865;&#x507F;&#x65F6;&#x95F4;&#xFF0C;&#x9632;&#x6B62;&#x7531;&#x4E8E;GC&#x6216;&#x8005;&#x672C;&#x5730;&#x65F6;&#x95F4;&#x9020;&#x6210;&#x7684;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x8BEF;&#x5DEE;&#xFF0C;&#x786E;&#x4FDD;&#x80FD;&#x591F;&#x6309;&#x7167;&#x9884;&#x671F;&#x65F6;&#x95F4;&#x6267;&#x884C;</span></span><br><span class="line">            <span class="keyword">if</span> (lease.isExpired(additionalLeaseMs) &amp;&amp; lease.getHolder() != <span class="keyword">null</span>) {</span><br><span class="line">               <span class="comment">// &#x5C06;&#x8FC7;&#x671F;&#x79DF;&#x7EA6;&#x52A0;&#x5165;&#x8FC7;&#x671F;&#x5217;&#x8868;</span></span><br><span class="line">               expiredLeases.add(lease);</span><br><span class="line">            }</span><br><span class="line">         }</span><br><span class="line">   }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>&#x8BA1;&#x7B97;&#x53EF;&#x88AB;&#x5254;&#x9664;&#x7684;&#x8FC7;&#x671F;&#x5B9E;&#x4F8B;&#x6570;&#xFF08;&#x8FC7;&#x671F;&#x6570; = Math.min(&#x8FC7;&#x671F;&#x5217;&#x8868;&#x5927;&#x5C0F;, (&#x672C;&#x5730;&#x79DF;&#x7EA6;&#x6570; - &#x672C;&#x5730;&#x79DF;&#x7EA6;&#x6570; * &#x7EED;&#x7EA6;&#x767E;&#x5206;&#x6BD4;))&#xFF09;<br><code>AbstractInstanceRegistry.java</code> 612&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &#x83B7;&#x53D6;&#x672C;&#x5730;&#x79DF;&#x7EA6;&#x6570;</span></span><br><span class="line"><span class="keyword">int</span> registrySize = (<span class="keyword">int</span>) getLocalRegistrySize();</span><br><span class="line"><span class="comment">// &#x8BA1;&#x7B97;&#x79DF;&#x7EA6;</span></span><br><span class="line"><span class="keyword">int</span> registrySizeThreshold = (<span class="keyword">int</span>) (registrySize * serverConfig.getRenewalPercentThreshold());</span><br><span class="line"><span class="comment">// &#x5B9E;&#x9645;&#x9700;&#x8981;&#x5254;&#x9664;&#x7684;&#x79DF;&#x7EA6;&#x4E2A;&#x6570;</span></span><br><span class="line"><span class="keyword">int</span> evictionLimit = registrySize - registrySizeThreshold;</span><br></pre></td></tr></tbody></table></figure></li><li><p>&#x4F7F;&#x7528;&#x6D17;&#x724C;&#x7B97;&#x6CD5;&#x627E;&#x51FA;&#x9700;&#x8981;&#x5254;&#x9664;&#x7684;n&#x4E2A;&#x5B9E;&#x4F8B;<br><code>AbstractInstanceRegistry.java</code> 620&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &#x6309;&#x7167;&#x5254;&#x9664;&#x6570;&#x904D;&#x5386;&#xFF0C;&#x6BCF;&#x6B21;&#x7684;&#x4EA4;&#x6362;&#x5BF9;&#x8C61;&#x90FD;&#x662F;&#x57FA;&#x4E8E;&#x4E0A;&#x6B21;&#x7684;&#x968F;&#x673A;&#x7ED3;&#x679C;</span></span><br><span class="line">Random random = <span class="keyword">new</span> Random(System.currentTimeMillis());</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; toEvict; i++) {</span><br><span class="line">   <span class="comment">// &#x7B5B;&#x9009;&#x51FA;&#x9700;&#x8981;&#x4EA4;&#x6362;&#x4F4D;&#x7F6E;&#x7684;&#x7D22;&#x5F15;next&#x5E76;&#x4E0E;i&#x4EA4;&#x6362;&#x4F4D;&#x7F6E;</span></span><br><span class="line">   <span class="keyword">int</span> next = i + random.nextInt(expiredLeases.size() - i);</span><br><span class="line">   Collections.swap(expiredLeases, i, next);</span><br><span class="line">   <span class="comment">// &#x5254;&#x9664;&#x903B;&#x8F91;</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>&#x8BBE;&#x7F6E;&#x79DF;&#x7EA6;&#x8FC7;&#x671F;&#x65F6;&#x95F4;<code>evictionTimestamp</code>&#x4E3A;&#x5F53;&#x524D;&#x65F6;&#x95F4;</p></li><li>&#x5C06;&#x6B64;&#x6B21;&#x5220;&#x9664;&#x589E;&#x52A0;&#x5230;&#x53D8;&#x66F4;&#x961F;&#x5217;&#x4E2D;</li><li>&#x6E05;&#x7A7A;&#x8BFB;&#x5199;&#x7F13;&#x5B58;</li></ol><h4 id="eureka&#x670D;&#x52A1;&#x7AEF;&#x4E0E;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x8282;&#x70B9;&#x7684;&#x901A;&#x8BAF;"><a href="#eureka&#x670D;&#x52A1;&#x7AEF;&#x4E0E;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x8282;&#x70B9;&#x7684;&#x901A;&#x8BAF;" class="headerlink" title="eureka&#x670D;&#x52A1;&#x7AEF;&#x4E0E;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x8282;&#x70B9;&#x7684;&#x901A;&#x8BAF;"></a>eureka&#x670D;&#x52A1;&#x7AEF;&#x4E0E;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x8282;&#x70B9;&#x7684;&#x901A;&#x8BAF;</h4><p>eureka&#x670D;&#x52A1;&#x7AEF;&#x4E0E;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x8282;&#x70B9;&#x7684;&#x901A;&#x8BAF;&#x4E3B;&#x8981;&#x5305;&#x542B;&#x4E24;&#x90E8;&#x5206;&#xFF1A;</p><ol><li>eureka&#x670D;&#x52A1;&#x7AEF;&#x542F;&#x52A8;&#x65F6;&#x5019;&#x81EA;&#x52A8;&#x62C9;&#x53D6;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x8282;&#x70B9;&#x7684;&#x6CE8;&#x518C;&#x4FE1;&#x606F;&#x5E76;&#x843D;&#x5165;&#x672C;&#x5730;<code>Registry</code>&#x4E2D;</li><li>&#x4E00;&#x65E6;&#x6709;&#x8BF8;&#x5982;<code>register</code>,<code>renew</code>,<code>cancel</code>&#x8BF7;&#x6C42;&#xFF0C;&#x5219;&#x4F1A;&#x5C06;&#x8FD9;&#x4E9B;&#x8BF7;&#x6C42;&#x901A;&#x8FC7;&#x7EBF;&#x7A0B;&#x6C60;&#x81EA;&#x52A8;&#x540C;&#x6B65;&#x81F3;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x8282;&#x70B9;</li></ol><h5 id="&#x542F;&#x52A8;&#x521D;&#x59CB;&#x5316;"><a href="#&#x542F;&#x52A8;&#x521D;&#x59CB;&#x5316;" class="headerlink" title="&#x542F;&#x52A8;&#x521D;&#x59CB;&#x5316;"></a>&#x542F;&#x52A8;&#x521D;&#x59CB;&#x5316;</h5><ol><li><p>Servlet&#x5BB9;&#x5668;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x8C03;&#x7528;eureka&#x73AF;&#x5883;&#x521D;&#x59CB;&#x5316;&#x4EE5;&#x53CA;eureka&#x4E0A;&#x4E0B;&#x6587;&#x521D;&#x59CB;&#x5316;<br><code>EurekaBootstrap.java</code> 111&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent event)</span> </span>{</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        <span class="comment">// &#x521D;&#x59CB;&#x5316;&#x73AF;&#x5883;</span></span><br><span class="line">        initEurekaEnvironment();</span><br><span class="line">        <span class="comment">// &#x521D;&#x59CB;&#x5316;&#x4E0A;&#x4E0B;&#x6587;</span></span><br><span class="line">        initEurekaServerContext();</span><br><span class="line"></span><br><span class="line">        ServletContext sc = event.getServletContext();</span><br><span class="line">        sc.setAttribute(EurekaServerContext.class.getName(), serverContext);</span><br><span class="line">    } <span class="keyword">catch</span> (Throwable e) {</span><br><span class="line">        logger.error(<span class="string">&quot;Cannot bootstrap eureka server :&quot;</span>, e);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;Cannot bootstrap eureka server :&quot;</span>, e);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li><li><p>&#x521D;&#x59CB;&#x5316;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x5F00;&#x59CB;&#x540C;&#x6B65;&#x5176;&#x4ED6;eureka&#x670D;&#x52A1;&#x8282;&#x70B9;&#x7684;&#x4FE1;&#x606F;<br><code>EurekaBootstrap.java</code> 147&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">initEurekaServerContext</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">    <span class="comment">// ...&#x5176;&#x4ED6;&#x903B;&#x8F91;</span></span><br><span class="line">    ApplicationInfoManager applicationInfoManager = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// &#x521D;&#x59CB;&#x5316;eureka&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x7528;&#x4E8E;&#x505A;&#x4E3A;&#x83B7;&#x53D6;&#x5176;&#x4ED6;eureka&#x670D;&#x52A1;&#x4FE1;&#x606F;&#x7684;client</span></span><br><span class="line">    <span class="keyword">if</span> (eurekaClient == <span class="keyword">null</span>) {</span><br><span class="line">        EurekaInstanceConfig instanceConfig = isCloud(ConfigurationManager.getDeploymentContext())</span><br><span class="line">                ? <span class="keyword">new</span> CloudInstanceConfig()</span><br><span class="line">                : <span class="keyword">new</span> MyDataCenterInstanceConfig();</span><br><span class="line">        </span><br><span class="line">        applicationInfoManager = <span class="keyword">new</span> ApplicationInfoManager(</span><br><span class="line">                instanceConfig, <span class="keyword">new</span> EurekaConfigBasedInstanceInfoProvider(instanceConfig).get());</span><br><span class="line">        </span><br><span class="line">        EurekaClientConfig eurekaClientConfig = <span class="keyword">new</span> DefaultEurekaClientConfig();</span><br><span class="line">        eurekaClient = <span class="keyword">new</span> DiscoveryClient(applicationInfoManager, eurekaClientConfig);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        applicationInfoManager = eurekaClient.getApplicationInfoManager();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// &#x521D;&#x59CB;&#x5316;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x5B9E;&#x4F8B;&#x611F;&#x77E5;&#x7684;&#x6CE8;&#x518C;&#x5668;</span></span><br><span class="line">    PeerAwareInstanceRegistry registry;</span><br><span class="line">    <span class="keyword">if</span> (isAws(applicationInfoManager.getInfo())) {</span><br><span class="line">        <span class="comment">// aws &#x670D;&#x52A1;</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        registry = <span class="keyword">new</span> PeerAwareInstanceRegistryImpl(</span><br><span class="line">                eurekaServerConfig,</span><br><span class="line">                eurekaClient.getEurekaClientConfig(),</span><br><span class="line">                serverCodecs,</span><br><span class="line">                eurekaClient</span><br><span class="line">        );</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// &#x4E3A;&#x5176;&#x4ED6;eureka&#x670D;&#x52A1;&#x6CE8;&#x518C;eurekaNode&#x5B9E;&#x4F8B;</span></span><br><span class="line">    PeerEurekaNodes peerEurekaNodes = getPeerEurekaNodes(</span><br><span class="line">            registry,</span><br><span class="line">            eurekaServerConfig,</span><br><span class="line">            eurekaClient.getEurekaClientConfig(),</span><br><span class="line">            serverCodecs,</span><br><span class="line">            applicationInfoManager</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// servlet&#x5BB9;&#x5668;&#x521D;&#x59CB;&#x5316;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// &#x4ECE;&#x5176;&#x4ED6;&#x670D;&#x52A1;&#x62F7;&#x8D1D;&#x6CE8;&#x518C;&#x4FE1;&#x606F;</span></span><br><span class="line">    <span class="keyword">int</span> registryCount = registry.syncUp();</span><br><span class="line">    <span class="comment">// &#x7B49;&#x5F85;&#x63A5;&#x6536;&#x8BF7;&#x6C42;</span></span><br><span class="line">    registry.openForTraffic(applicationInfoManager, registryCount);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// &#x5176;&#x4ED6;&#x64CD;&#x4F5C;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><p>&#x540C;&#x6B65;&#x903B;&#x8F91;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">syncUp</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// &#x5C1D;&#x8BD5;&#x540C;&#x6B65;&#x76F4;&#x5230;&#x8FBE;&#x5230;&#x6700;&#x5927;&#x5C1D;&#x8BD5;&#x6B21;&#x6570;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; ((i &lt; serverConfig.getRegistrySyncRetries()) &amp;&amp; (count == <span class="number">0</span>)); i++) {</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span>) {</span><br><span class="line">            <span class="comment">// &#x5C1D;&#x8BD5;&#x95F4;&#x9694;&#x7761;&#x7720;&#x65F6;&#x95F4;</span></span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        }</span><br><span class="line">        <span class="comment">// &#x83B7;&#x53D6;&#x6240;&#x6709;&#x7684;&#x5E94;&#x7528;</span></span><br><span class="line">        Applications apps = eurekaClient.getApplications();</span><br><span class="line">        <span class="comment">// &#x83B7;&#x53D6;&#x6240;&#x6709;&#x6CE8;&#x518C;&#x7684;&#x5E94;&#x7528;</span></span><br><span class="line">        <span class="keyword">for</span> (Application app : apps.getRegisteredApplications()) {</span><br><span class="line">            <span class="keyword">for</span> (InstanceInfo instance : app.getInstances()) {</span><br><span class="line">                <span class="keyword">try</span> {</span><br><span class="line">                    <span class="comment">// &#x5224;&#x65AD;&#x5E94;&#x7528;&#x662F;&#x5426;&#x5728;&#x5F53;&#x524D;&#x533A;&#x57DF;&#x6CE8;&#x518C;</span></span><br><span class="line">                    <span class="comment">// &#x8BE5;&#x914D;&#x7F6E;&#x53EA;&#x5BF9;&#x4E8E;AWS&#x6709;&#x6548;&#xFF0C;&#x5176;&#x4ED6;&#x975E;AWS&#x670D;&#x52A1;&#x5168;&#x90E8;&#x4F1A;&#x62C9;&#x53D6;</span></span><br><span class="line">                    <span class="keyword">if</span> (isRegisterable(instance)) {</span><br><span class="line">                        <span class="comment">// &#x662F;&#xFF0C;&#x5219;&#x843D;&#x5165;&#x672C;&#x5730;&#x5185;&#x5B58;</span></span><br><span class="line">                        register(instance, instance.getLeaseInfo().getDurationInSecs(), <span class="keyword">true</span>);</span><br><span class="line">                        count++;</span><br><span class="line">                    }</span><br><span class="line">                } <span class="keyword">catch</span> (Throwable t) {</span><br><span class="line">                    logger.error(<span class="string">&quot;During DS init copy&quot;</span>, t);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ol start="3"><li>&#x5B8C;&#x6210;&#x540E;&#x5F00;&#x59CB;&#x63A5;&#x6536;&#x8BF7;&#x6C42;</li></ol><h5 id="&#x8FC7;&#x7A0B;&#x4E2D;&#x540C;&#x6B65;"><a href="#&#x8FC7;&#x7A0B;&#x4E2D;&#x540C;&#x6B65;" class="headerlink" title="&#x8FC7;&#x7A0B;&#x4E2D;&#x540C;&#x6B65;"></a>&#x8FC7;&#x7A0B;&#x4E2D;&#x540C;&#x6B65;</h5><p>&#x4EE5;&#x6CE8;&#x518C;&#x540C;&#x6B65;&#x4E3A;&#x4F8B;&#x5B50;&#x3002;</p><ol><li><p>&#x6839;&#x636E;&#x8BF7;&#x6C42;&#x7C7B;&#x578B;&#x5224;&#x65AD;&#x6267;&#x884C;&#x52A8;&#x4F5C;<br><code>PeerAwareInstanceRegistry.java</code> 648&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> Cancel:</span><br><span class="line">    node.cancel(appName, id);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> Heartbeat:</span><br><span class="line">    InstanceStatus overriddenStatus = overriddenInstanceStatusMap.get(id);</span><br><span class="line">    infoFromRegistry = getInstanceByAppAndId(appName, id, <span class="keyword">false</span>);</span><br><span class="line">    node.heartbeat(appName, id, infoFromRegistry, overriddenStatus, <span class="keyword">false</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> Register:</span><br><span class="line">    <span class="comment">// &#x8C03;&#x7528;PeerEurekaNode&#x7684;register&#x65B9;&#x6CD5;&#x6267;&#x884C;&#x6CE8;&#x518C;&#x52A8;&#x4F5C;&#x7684;&#x540C;&#x6B65;</span></span><br><span class="line">    node.register(info);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> StatusUpdate:</span><br><span class="line">    infoFromRegistry = getInstanceByAppAndId(appName, id, <span class="keyword">false</span>);</span><br><span class="line">    node.statusUpdate(appName, id, newStatus, infoFromRegistry);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> DeleteStatusOverride:</span><br><span class="line">    infoFromRegistry = getInstanceByAppAndId(appName, id, <span class="keyword">false</span>);</span><br><span class="line">    node.deleteStatusOverride(appName, id, infoFromRegistry);</span><br><span class="line">    <span class="keyword">break</span>;</span><br></pre></td></tr></tbody></table></figure></li><li><p>&#x5C06;&#x4EFB;&#x52A1;&#x63D0;&#x4EA4;&#x81F3;&#x4EFB;&#x52A1;&#x5904;&#x7406;&#x5668;<code>TaskDispatcher</code>&#x8FDB;&#x884C;<br><code>PeerEurekaNode.java</code> 135&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> expiryTime = System.currentTimeMillis() + getLeaseRenewalOf(info);</span><br><span class="line">batchingDispatcher.process(</span><br><span class="line">        taskId(<span class="string">&quot;register&quot;</span>, info),</span><br><span class="line">        <span class="comment">// &#x540C;&#x6B65;&#x4EFB;&#x52A1;&#x4FE1;&#x606F;</span></span><br><span class="line">        <span class="keyword">new</span> InstanceReplicationTask(targetHost, Action.Register, info, <span class="keyword">null</span>, <span class="keyword">true</span>) {</span><br><span class="line">            <span class="function"><span class="keyword">public</span> EurekaHttpResponse&lt;Void&gt; <span class="title">execute</span><span class="params">()</span> </span>{</span><br><span class="line">                <span class="keyword">return</span> replicationClient.register(info);</span><br><span class="line">            }</span><br><span class="line">        },</span><br><span class="line">        expiryTime</span><br><span class="line">);</span><br></pre></td></tr></tbody></table></figure></li><li><p>&#x8C03;&#x7528;Jersey2&#x6267;&#x884C;REST&#x8BF7;&#x6C42;<br><code>AbstractJersey2EurekaHttpClient.java</code> 85&#x884C;&#xFF1A;</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> EurekaHttpResponse&lt;Void&gt; <span class="title">register</span><span class="params">(InstanceInfo info)</span> </span>{</span><br><span class="line">    String urlPath = <span class="string">&quot;apps/&quot;</span> + info.getAppName();</span><br><span class="line">    Response response = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        <span class="comment">// &#x5C01;&#x88C5;&#x8BF7;&#x6C42;</span></span><br><span class="line">        Builder resourceBuilder = jerseyClient.target(serviceUrl).path(urlPath).request();</span><br><span class="line">        addExtraProperties(resourceBuilder);</span><br><span class="line">        <span class="comment">// &#x8BBE;&#x7F6E;x-netflix-discovery-replication&#x5934;&#x4FE1;&#x606F;&#x4E3A;true&#xFF0C;&#x5176;&#x4ED6;eureka&#x670D;&#x52A1;&#x8282;&#x70B9;&#x63A5;&#x6536;&#x540E;&#x4F1A;&#x77E5;&#x6653;&#x8FD9;&#x662F;&#x4E2A;&#x540C;&#x6B65;&#x8BF7;&#x6C42;</span></span><br><span class="line">        addExtraHeaders(resourceBuilder);</span><br><span class="line">        <span class="comment">// &#x6267;&#x884C;&#x8BF7;&#x6C42;&#x5E76;&#x83B7;&#x53D6;&#x7ED3;&#x679C;</span></span><br><span class="line">        response = resourceBuilder</span><br><span class="line">                .accept(MediaType.APPLICATION_JSON)</span><br><span class="line">                .acceptEncoding(<span class="string">&quot;gzip&quot;</span>)</span><br><span class="line">                .post(Entity.json(info));</span><br><span class="line">        <span class="keyword">return</span> anEurekaHttpResponse(response.getStatus()).headers(headersOf(response)).build();</span><br><span class="line">    } <span class="keyword">finally</span> {</span><br><span class="line">        <span class="keyword">if</span> (logger.isDebugEnabled()) {</span><br><span class="line">            logger.debug(<span class="string">&quot;Jersey2 HTTP POST {}/{} with instance {}; statusCode={}&quot;</span>, serviceUrl, urlPath, info.getId(),</span><br><span class="line">                    response == <span class="keyword">null</span> ? <span class="string">&quot;N/A&quot;</span> : response.getStatus());</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (response != <span class="keyword">null</span>) {</span><br><span class="line">            response.close();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ol><h4 id="Eureka&#x81EA;&#x6211;&#x4FDD;&#x62A4;&#x673A;&#x5236;"><a href="#Eureka&#x81EA;&#x6211;&#x4FDD;&#x62A4;&#x673A;&#x5236;" class="headerlink" title="Eureka&#x81EA;&#x6211;&#x4FDD;&#x62A4;&#x673A;&#x5236;"></a>Eureka&#x81EA;&#x6211;&#x4FDD;&#x62A4;&#x673A;&#x5236;</h4><p>Eureka&#x662F;Netflix&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x73B0;&#x6709;AWS&#x7684;&#x6CE8;&#x518C;&#x670D;&#x52A1;&#x65E0;&#x6CD5;&#x89E3;&#x51B3;&#x7684;&#x4E00;&#x4E9B;&#x573A;&#x666F;&#x800C;&#x4E13;&#x95E8;&#x7814;&#x53D1;&#x7684;&#x3002;&#x5728;&#x8BBE;&#x8BA1;&#x4E4B;&#x521D;&#xFF0C;&#x5C31;&#x8003;&#x8651;&#x5230;&#x9AD8;&#x53EF;&#x7528;&#x7279;&#x6027;&#xFF0C;&#x9632;&#x6B62;AWS&#x7A81;&#x7136;&#x6027;&#x7684;&#x5927;&#x89C4;&#x6A21;&#x65AD;&#x70B9;&#x9020;&#x6210;&#x670D;&#x52A1;&#x4E0D;&#x53EF;&#x7528;&#x7684;&#x60C5;&#x51B5;&#x8BBE;&#x8BA1;&#x4E86;Eureka&#x7684;&#x81EA;&#x6211;&#x4FDD;&#x62A4;&#x673A;&#x5236;&#x3002;</p><p>Eureka&#x7684;&#x81EA;&#x6211;&#x4FDD;&#x62A4;&#x673A;&#x5236;&#x8BBE;&#x5B9A;&#x4E3A;&#xFF1A;&#x670D;&#x52A1;&#x603B;&#x6570; <em>&#x6BCF;&#x5206;&#x949F;&#x7EED;&#x7EA6;&#x6570;&#xFF08;60s / &#x5BA2;&#x6237;&#x7AEF;&#x7EED;&#x7EA6;&#x95F4;&#x9694;&#xFF09; </em>&#x81EA;&#x6211;&#x4FDD;&#x62A4;&#x9608;&#x503C;&#x56E0;&#x5B50;</p><p>&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#x8BF4;&#x660E;&#xFF1A;<br>&#x5982;&#x679C;&#x67D0;&#x4E2A;&#x5E94;&#x7528;A&#x6709;100&#x4E2A;&#x670D;&#x52A1;&#x5B9E;&#x4F8B;&#xFF0C;&#x90A3;&#x4E48;&#x6309;&#x7167;&#x516C;&#x5F0F;&#x8BA1;&#x7B97;&#xFF0C;&#x5B83;&#x5728;&#x4E00;&#x5206;&#x949F;&#x5185;&#x7EED;&#x7EA6;&#x6B21;&#x6570;&#x5FC5;&#x987B; &gt;= 170&#x3002;</p><p>&#x5982;&#x679C;&#x5728;&#x4E0A;&#x4E00;&#x4E2A;&#x5206;&#x949F;&#x5185;&#xFF0C;&#x7EED;&#x7EA6;&#x6570; &gt; 170&#xFF0C;&#x90A3;&#x4E48;&#x670D;&#x52A1;&#x6B63;&#x5E38;&#xFF0C;&#x67D0;&#x4E2A;&#x5B9E;&#x4F8B;&#x5C31;&#x7B97;&#x5931;&#x8D25;&#x4E5F;&#x53EA;&#x4F1A;&#x8BA4;&#x4E3A;&#x662F;&#x5BA2;&#x6237;&#x7AEF;&#x5B58;&#x5728;&#x95EE;&#x9898;&#xFF0C;&#x4F1A;&#x88AB;&#x5254;&#x9664;&#xFF1B;<br>&#x5982;&#x679C;&#x5728;&#x4E0A;&#x4E00;&#x4E2A;&#x5206;&#x949F;&#x5185;&#xFF0C;&#x7EED;&#x7EA6;&#x6570; &lt; 170&#xFF0C;&#x90A3;&#x4E48;Eureka&#x5C31;&#x4F1A;&#x8BA4;&#x4E3A;&#x662F;Eureka&#x670D;&#x52A1;&#x5B58;&#x5728;&#x95EE;&#x9898;&#xFF0C;&#x4F1A;&#x505C;&#x6B62;&#x5254;&#x9664;&#x6D41;&#x7A0B;&#xFF0C;&#x4FDD;&#x62A4;&#x73B0;&#x6709;&#x7684;&#x6CE8;&#x518C;&#x4FE1;&#x606F;&#xFF0C;&#x9632;&#x6B62;&#x670D;&#x52A1;&#x5927;&#x89C4;&#x6A21;&#x4E0B;&#x7EBF;&#x3002;</p><h3 id="Eureka&#x4E0E;ZK&#x7684;&#x6BD4;&#x8F83;"><a href="#Eureka&#x4E0E;ZK&#x7684;&#x6BD4;&#x8F83;" class="headerlink" title="Eureka&#x4E0E;ZK&#x7684;&#x6BD4;&#x8F83;"></a>Eureka&#x4E0E;ZK&#x7684;&#x6BD4;&#x8F83;</h3><h4 id="CAP&#x6A21;&#x578B;"><a href="#CAP&#x6A21;&#x578B;" class="headerlink" title="CAP&#x6A21;&#x578B;"></a>CAP&#x6A21;&#x578B;</h4><p><img src="https://static.xuqiang.me/public/images/182704.jpg" alt="CAP&#x6A21;&#x578B;"></p><p>Eureka&#x662F;AP&#x6A21;&#x578B;&#xFF0C;ZK&#x662F;CP&#x6A21;&#x578B;&#x3002;&#x524D;&#x8005;&#x5F3A;&#x8C03;&#x9AD8;&#x53EF;&#x7528;&#xFF0C;&#x5373;&#x4F7F;&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x540C;region&#x770B;&#x5230;&#x7684;&#x89C6;&#x56FE;&#x53EF;&#x80FD;&#x4E0D;&#x4E00;&#x81F4;&#xFF1B;&#x800C;&#x540E;&#x8005;&#x5F3A;&#x8C03;&#x7684;&#x662F;&#x5F3A;&#x4E00;&#x81F4;&#x6027;&#xFF0C;&#x4E14;&#x5728;&#x8D85;&#x8FC7;&#x4E00;&#x5B9A;&#x9608;&#x503C;&#x540E;&#x4F1A;&#x9020;&#x6210;ZK&#x96C6;&#x7FA4;&#x6574;&#x4F53;&#x4E0D;&#x53EF;&#x7528;</p><h4 id="&#x5E94;&#x7528;&#x573A;&#x666F;"><a href="#&#x5E94;&#x7528;&#x573A;&#x666F;" class="headerlink" title="&#x5E94;&#x7528;&#x573A;&#x666F;"></a>&#x5E94;&#x7528;&#x573A;&#x666F;</h4><table><thead><tr><th>&#x573A;&#x666F;</th><th>Eureka</th><th>ZK</th></tr></thead><tbody><tr><td>&#x6570;&#x636E;&#x5206;&#x53D1;&#x548C;&#x8BA2;&#x9605;</td><td>&#xD7;</td><td>&#x221A;</td></tr><tr><td>&#x5F02;&#x5730;&#x5927;&#x89C4;&#x6A21;&#x96C6;&#x7FA4;&#x9700;&#x6C42;&#x7684;&#x6CE8;&#x518C;&#x4E2D;&#x5FC3;</td><td>&#x221A;</td><td>&#xD7;</td></tr><tr><td>&#x5C0F;&#x89C4;&#x6A21;&#x5355;&#x673A;&#x623F;&#x6CE8;&#x518C;&#x4E2D;&#x5FC3;</td><td>&#x221A;</td><td>&#x221A;</td></tr></tbody></table><script>document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });</script></div></div><div class="article-copyright"><div class="copyright"><p><span>本文标题:</span><a href="/Eureka内核逻辑解析.html">Eureka内核逻辑解析</a></p><p><span>文章作者:</span><a href="/" title="访问 WhatAKitty 的个人博客">WhatAKitty</a></p><p><span>发布时间:</span>2020年06月30日 - 01时23分</p><p><span>最后更新:</span>2020年06月30日 - 02时39分</p><p><span>原始链接:</span><a href="/Eureka内核逻辑解析.html" title="Eureka内核逻辑解析">https://xuqiang.me/Eureka内核逻辑解析.html</a> <span class="btn" data-clipboard-text="原文: https://xuqiang.me/Eureka内核逻辑解析.html　　作者: WhatAKitty" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。</p></div><br><br><style type="text/css">.copyright p .btn{margin-left:1em}.copyright:hover p .btn::after{content:"复制"}.copyright p .btn:hover{color:gray;cursor:pointer}</style></div><div class="article-footer"><div class="article-meta pull-left"><span class="post-categories"><i class="icon-categories"></i> <a href="/categories/Java/">Java</a>, <a href="/categories/Java/Eureka/">Eureka</a>, <a href="/categories/Java/Eureka/EurekaSources/">EurekaSources</a> </span><span class="post-tags"><i class="icon-tags"></i> <a href="/tags/java/">java</a><a href="/tags/eureka/">eureka</a><a href="/tags/HA/">HA</a></span></div><script src="https://cdn.staticfile.org/mermaid/8.0.0/mermaid.min.js"></script><script>window.mermaid&&mermaid.initialize({theme:"forest"},".mermaid")</script></div><div style="text-align:center;margin-top:80px"><div id="cyReward" role="cylabs" data-use="reward" sid="cc09f0d1065d0d7c4f0642403d0b72cd" cid="1"></div></div></article><section id="comments"><script>talkyardServerUrl="https://comments-for-xuqiang-me.talkyard.net"</script><script async defer src="https://c1.ty-cdn.net/-/talkyard-comments.min.js"></script><div class="talkyard-comments" data-discussion-id="Eureka内核逻辑解析" style="margin-top:45px"><noscript>Please enable Javascript to view comments.</noscript></div></section></main><footer class="site-footer"><script async src="//static.xuqiang.me/busuanzi.pure.mini.js"></script><p class="site-info">Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a><br>&copy; 2020 WhatAKitty | <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span><br><a href="https://blog.whatakitty.com">浙ICP备15019585号</a> <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33010602008839" style="display:block;line-height:20px"><span style="display:inline-block;line-height:20px;vertical-align:middle"><img src="https://static.xuqiang.me/public/images/beian.png" style="width:20px;height:20px"></span><span style="display:inline-block;height:20px;line-height:20px;margin:0 0 0 5px">浙公网安备 33010602008839号</span></a></p></footer><script async src="https://www.googletagmanager.com/gtag/js?id=UA-35184058-2"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-35184058-2"),gtag("set",{user_id:"USER_ID"})</script></div></div></body></html>
